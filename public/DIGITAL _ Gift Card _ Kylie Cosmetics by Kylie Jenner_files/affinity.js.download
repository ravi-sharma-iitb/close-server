!function(){"use strict";function o(o,t,n,e){void 0===n&&(n=!0),void 0===e&&(e=!0);var r=new XMLHttpRequest;if("withCredentials"in r)r.open(o,t,e),r.withCredentials=n;else{if("undefined"==typeof XDomainRequest)return null;(r=new XDomainRequest).open(o,t)}return r}var t={"NA-boostHost":"https://coin.amazonpay.com","EU-boostHost":"https://coin-eu.amazonpay.com","FE-boostHost":"https://coin-fe.amazonpay.com"},n={NA:"NA-boostHost",EU:"EU-boostHost",UK:"EU-boostHost",FE:"FE-boostHost"};var e="/cs/uedata";function r(r){var i,s,a=o("POST",""+((i=r.countryOfEstablishment)in n?t[n[i]]:null)+e,!1);if(a){var u=[["sellerId",(s=r).sellerId],["countryOfEstablishment",s.countryOfEstablishment],["ledgerCurrency",s.ledgerCurrency],["data",s.data],["productType",s.productType],["platformType",s.platformType]].filter(function(o){o[0];var t=o[1];return null!=t}).map(function(o){return o[0]+"="+o[1]}).join("&");a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onload=function(){},a.send(u)}}var i=["InvalidTimestampFormat","ExpiredRequest","InvalidSignature","DuplicateRequestId","UnknownError","InvalidRegion"],s={"NA-boostHost":"https://coin.amazonpay.com","EU-boostHost":"https://coin-eu.amazonpay.com","FE-boostHost":"https://coin-fe.amazonpay.com"},a={NA:"NA-boostHost",EU:"EU-boostHost",UK:"EU-boostHost",FE:"FE-boostHost"},u=Date.now(),p="UnknownError",c="InvalidRegion";function f(o,t){r({sellerId:o.merchantId,countryOfEstablishment:o.region,ledgerCurrency:"N/A",data:JSON.stringify({latency:t}),productType:"COIN",platformType:"P2"})}(function(o){for(var t=o.split("."),n=window,e=0,r=t;e<r.length;e++){var i=r[e];n[i]||(n[i]={}),n=n[i]}return n}("AmazonPay")).affinity=function(t){u=Date.now();var n,e=function(o){if(o in a){var t=a[o];return s[t]}}(t.region);if("string"==typeof e){var r=o("GET",e+"/customerInsight?"+function(o){var t=[];return t.push(["merchantId",o.merchantId]),t.push(["region",o.region]),t.push(["requestId",o.requestId]),t.push(["timestamp",o.timestamp]),t.push(["publicKeyId",o.keyPairName]),t.push(["domain",o.domain]),t.push(["solutionProviderMerchantId",o.solutionProviderId]),t.push(["responseSimulation",o.responseSimulation]),t.push(["signature",o.signature]),t.filter(function(o){return o[0],!(null==o[1])}).map(function(o){return o[0]+"="+o[1]}).join("&")}(t),!0);r&&(r.onload=function(o,t){return function(){var n,e,r,s;try{n=JSON.parse(t.responseText)}catch(t){return"function"==typeof o.onError&&o.onError(p),void f(o,(Date.now()-u).toFixed(2))}if(200===t.status)"function"==typeof o.onResponse&&o.onResponse(n);else if("function"==typeof o.onError){var a=(e=n.code,s=p,(r=i).indexOf(e)>=0?e:s||r[0]);o.onError(a)}f(o,(Date.now()-u).toFixed(2))}}(t,r),r.onerror=(n=t,function(){"function"==typeof n.onError&&n.onError(p),f(n,(Date.now()-u).toFixed(2))}),r.send())}else"function"==typeof t.onError&&t.onError(c)}}();
//# sourceMappingURL=affinity.js.map
