!function(t,i,n){var o=function(){function t(){var t=o.height(),a=o.scrollTop(),s=a+t;i.each(n,function(){var t=i(this),n=i(t).outerHeight(),o=i(t).offset().top,r=o+n;r>=a&&o<=s?e.removeClass("is-active"):e.addClass("is-active")})}var n=i.find(".holiday--header"),o=i(window),e=i("#navigation");i(window).width()>1140&&(i(window).on("scroll resize",function(){t()}),i(window).trigger("scroll"))},e=function(){function t(){for(var t=0;t<f.length;t++)f[t].update()}function i(){this.x=a(0,c),this.y=a(-d,0),this.radius=a(.5,3),this.speed=a(1,3),this.wind=a(-.5,3)}function n(t){for(var n=0;n<t;n++)f[n]=new i}function o(){r.clearRect(0,0,r.canvas.width,r.canvas.height);for(var t=0;t<f.length;t++)f[t].draw()}function e(){o(),t(),l(e)}function a(t,i){var n=(t+Math.random()*(i-t)).toFixed(1);return n=Math.round(n)}var s=document.getElementById("snow"),r=s.getContext("2d"),c=r.canvas.width=document.body.offsetWidth,d=r.canvas.height=document.body.offsetHeight,l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame,f=[];window.onresize=function(){c=r.canvas.width=document.body.offsetWidth,d=r.canvas.height=document.body.offsetHeight},i.prototype.draw=function(){r.beginPath(),r.arc(this.x,this.y,this.radius,0,2*Math.PI),r.fillStyle="#fff",r.fill(),r.closePath()},i.prototype.update=function(){this.y+=this.speed,this.x+=this.wind,this.y>r.canvas.height&&(this.y=0,this.x=a(0,c))},n(150),e()};t.init=function(){o(),e()}}(window.Holiday=window.Holiday||{},jQuery),function(t,i,n){function o(t){i.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),cache:!1,dataType:"json",contentType:"application/json; charset=utf-8",error:function(t){i(".modal-form").hide(),i(".modal-text").hide(),i("#notification_container, #notification_container-two").html('<span class="alert">Could not connect to server. Please try again later.</span>'),i("#notification_container, #notification_container-two").fadeIn(),e.addClass("force-reload"),s.addClass("force-reload")},success:function(n){if("success"!=n.result){var o=n.msg.substring(0),a='<span class="alert">Could not connect to server. Please try again later.</span>';o.indexOf("is already subscribed to list")>-1?a='<span class="alert">THANKS! YOU\'RE ALREADY ON THE LIST</span>':o.indexOf("Too many subscribe attempts for this email")>-1&&(a='<span class="alert">Too many subscribe attempts for this email address.<br />Please try again in about 5 minutes!</span>'),i("#notification_container, #notification_container-two").html(a),i("#notification_container, #notification_container-two").fadeIn(),e.addClass("force-reload"),s.addClass("force-reload")}else{var o=n.msg;t.hide(),i("#notification_container, #notification_container-two").html('<span class="alert-sucess">Thank you for signing up</span>'),i("a.show-lip-kits").text("Close window"),i("#notification_container, #notification_container-two").fadeIn(),i.cookie("kylieBirthday","subscriber",{expires:365,path:"/"})}}})}var e=i(".newsletter-modal"),a=i(".newsletter-modal .modal-contents"),s=i(".close-modal"),r=i("#mc-embedded-subscribe-form"),c=i("#mc-embedded-subscribe-form-2"),d=i(".icon-close"),l=window.shop.emailPop,h=function(){i(".kylie-email-holder").focus(function(){i(this).data("placeholder",i(this).attr("placeholder")).attr("placeholder","")}).blur(function(){i(this).attr("placeholder",i(this).data("placeholder"))}),e.click(function(){i(this).hasClass("force-reload")?window.location.reload():e.fadeOut()}),i("a.show-lip-kits").click(function(){return i("[data-remodal-id=modal]").remodal().close(),!1}),d.click(function(){return i("body").removeClass("email-active"),!1}),a.click(function(t){t.stopPropagation()}),r.submit(function(t){t.preventDefault(),o(r),e.fadeIn()}),c.submit(function(t){t.preventDefault(),o(c)})};t.init=function(){1==l,h()}}(window.NewsletterModal=window.NewsletterModal||{},jQuery),function(t,i){var n=function(){i(".hp-slider").slick({slidesToShow:1,slidesToScroll:1,arrows:!0,lazyLoad:"progressive",autoplay:!0,autoplaySpeed:5e3})};t.init=function(){n()}}(window.Sliders=window.Sliders||{},jQuery,void 0),function(t,i){var n=function(){var t=(i("#pack-container"),767);i(function(){var n=document.querySelector("#pack-container");new Packery(n,{itemSelector:".item",gutter:0});i(window).width()>=t,i(window).on("resize",function(){i(window).width()>=t})}),i(".item a").click(function(){var t=i(this).attr("data-src-img"),n="<img src="+t+" class='item item--content'/>",o=i(".modal-fill");i(o).empty().append(n);var e={};i("[data-remodal-id=modal-gallery]").remodal(e).open()})};t.init=function(){n()}}(window.Valentine=window.Valentine||{},jQuery,void 0);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkhvbGlkYXkuanMiLCJOZXdzbGV0dGVyTW9kYWwuanMiLCJTbGlkZXJzLmpzIiwiVmFsZW50aW5lLmpzIl0sIm5hbWVzIjpbIkhvbGlkYXkiLCIkIiwidW5kZWZpbmVkIiwiaGVhZGVyU2Nyb2xsIiwiY2hlY2tfaWZfaW5fdmlldyIsIndpbmRvd19oZWlnaHQiLCJ3ZWJfd2luZG93IiwiaGVpZ2h0Iiwid2luZG93X3RvcF9wb3NpdGlvbiIsInNjcm9sbFRvcCIsIndpbmRvd19ib3R0b21fcG9zaXRpb24iLCJlYWNoIiwiYW5pbWF0aW9uX2VsZW1lbnRzIiwiZWxlbWVudCIsInRoaXMiLCJlbGVtZW50X2hlaWdodCIsIm91dGVySGVpZ2h0IiwiZWxlbWVudF90b3BfcG9zaXRpb24iLCJvZmZzZXQiLCJ0b3AiLCJlbGVtZW50X2JvdHRvbV9wb3NpdGlvbiIsIiRoZWFkbmF2IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsImZpbmQiLCJ3aW5kb3ciLCJ3aWR0aCIsIm9uIiwidHJpZ2dlciIsImJpbmRVSUFjdGlvbnMiLCJ1cGRhdGUiLCJpIiwic25vd2ZsYWtlcyIsImxlbmd0aCIsIlNub3ciLCJ4IiwicmFuZG9tIiwieSIsInJhZGl1cyIsInNwZWVkIiwid2luZCIsImNyZWF0ZVNub3ciLCJjb3VudCIsImRyYXciLCJjdHgiLCJjbGVhclJlY3QiLCJjYW52YXMiLCJsb29wIiwiYW5pbUZyYW1lIiwibWluIiwibWF4IiwicmFuZCIsIk1hdGgiLCJ0b0ZpeGVkIiwicm91bmQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiZ2V0Q29udGV4dCIsImJvZHkiLCJvZmZzZXRXaWR0aCIsIm9mZnNldEhlaWdodCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1velJlcXVlc3RBbmltYXRpb25GcmFtZSIsIndlYmtpdFJlcXVlc3RBbmltYXRpb25GcmFtZSIsIm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwib25yZXNpemUiLCJwcm90b3R5cGUiLCJiZWdpblBhdGgiLCJhcmMiLCJQSSIsImZpbGxTdHlsZSIsImZpbGwiLCJjbG9zZVBhdGgiLCJpbml0IiwialF1ZXJ5IiwiTmV3c2xldHRlck1vZGFsIiwicmVnaXN0ZXIiLCIkZm9ybSIsImFqYXgiLCJ0eXBlIiwiYXR0ciIsInVybCIsImRhdGEiLCJzZXJpYWxpemUiLCJjYWNoZSIsImRhdGFUeXBlIiwiY29udGVudFR5cGUiLCJlcnJvciIsImVyciIsImhpZGUiLCJodG1sIiwiZmFkZUluIiwiJG5ld3NsZXR0ZXJNb2RhbFdyYXAiLCIkbmV3c2xldHRlck1vZGFsQ2xvc2UiLCJzdWNjZXNzIiwicmVzdWx0IiwibWVzc2FnZSIsIm1zZyIsInN1YnN0cmluZyIsIm5vdGlmaWNhdGlvbl9odG1sIiwiaW5kZXhPZiIsInRleHQiLCJjb29raWUiLCJleHBpcmVzIiwicGF0aCIsIiRuZXdzbGV0dGVyTW9kYWwiLCIkZm9ybTIiLCIkaWNvbkNsb3NlIiwiZW1haWxQb3AiLCJzaG9wIiwic2V0Q29va2llIiwidmlzaXRzIiwiaW5pdGlhbGl6ZU5ld3NsZXR0ZXJNb2RhbCIsInNldFRpbWVvdXQiLCJmb2N1cyIsImJsdXIiLCJjbGljayIsImhhc0NsYXNzIiwibG9jYXRpb24iLCJyZWxvYWQiLCJmYWRlT3V0IiwicmVtb2RhbCIsImNsb3NlIiwiZXZlbnQiLCJzdG9wUHJvcGFnYXRpb24iLCJzdWJtaXQiLCJwcmV2ZW50RGVmYXVsdCIsIlNsaWRlcnMiLCJzbGljayIsInNsaWRlc1RvU2hvdyIsInNsaWRlc1RvU2Nyb2xsIiwiYXJyb3dzIiwibGF6eUxvYWQiLCJhdXRvcGxheSIsImF1dG9wbGF5U3BlZWQiLCJWYWxlbnRpbmUiLCIkTSIsImNvbnRhaW5lciIsInF1ZXJ5U2VsZWN0b3IiLCJQYWNrZXJ5IiwiaXRlbVNlbGVjdG9yIiwiZ3V0dGVyIiwiY29udGVudCIsImNvbnRlbnRDb250YWluZXIiLCJtb2RhbGZpbGwiLCJlbXB0eSIsImFwcGVuZCIsIm9wdGlvbnMiLCJvcGVuIl0sIm1hcHBpbmdzIjoiQ0FBQSxTQUFB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QSxTQUFBcUksRUFBQXRJLEdBQ0EsR0FBQTRCLEdBQUEsV0FDQSxHQUNBMkcsSUFEQXZJLEVBQUEsbUJBQ0EsSUFDQUEsR0FBQSxXQUdBLEdBQUF3SSxHQUFBbEYsU0FBQW1GLGNBQUEsa0JBQ0EsSUFBQUMsU0FBQUYsR0FFQUcsYUFBQSxRQUNBQyxPQUFBLEdBR0E1SSxHQUFBd0IsUUFBQUMsU0FBQThHLEVBSUF2SSxFQUFBd0IsUUFBQUUsR0FBQSxTQUFBLFdBQ0ExQixFQUFBd0IsUUFBQUMsU0FBQThHLE1BT0F2SSxFQUFBLFdBQUFtSCxNQUFBLFdBQ0EsR0FBQTBCLEdBQUE3SSxFQUFBYSxNQUFBa0UsS0FBQSxnQkFDQStELEVBQUEsWUFBQUQsRUFBQSxnQ0FDQUUsRUFBQS9JLEVBQUEsY0FDQUEsR0FBQStJLEdBQUFDLFFBQUFDLE9BQUFILEVBQ0EsSUFBQUksS0FDQWxKLEdBQUEsbUNBQUF3SCxRQUFBMEIsR0FBQUMsU0FLQWIsR0FBQTlELEtBQUEsV0FDQTVDLE1BR0FKLE9BQUE4RyxVQUFBOUcsT0FBQThHLGNBQUE3RCxPQUFBeEUiLCJmaWxlIjoiYnZhY2NlbC5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiAoSG9saWRheSwgJCwgdW5kZWZpbmVkKSB7XG4gIHZhciBoZWFkZXJTY3JvbGwgPSBmdW5jdGlvbiAoKSB7XG4gICAgLy93aW5kb3cgYW5kIGFuaW1hdGlvbiBpdGVtc1xuICAgIHZhciBhbmltYXRpb25fZWxlbWVudHMgPSAkLmZpbmQoJy5ob2xpZGF5LS1oZWFkZXInKTtcbiAgICB2YXIgd2ViX3dpbmRvdyA9ICQod2luZG93KTtcbiAgICB2YXIgJGhlYWRuYXYgPSAkKCcjbmF2aWdhdGlvbicpO1xuXG4gICAgLy9jaGVjayB0byBzZWUgaWYgYW55IGFuaW1hdGlvbiBjb250YWluZXJzIGFyZSBjdXJyZW50bHkgaW4gdmlld1xuICAgIGZ1bmN0aW9uIGNoZWNrX2lmX2luX3ZpZXcoKSB7XG4gICAgICAvL2dldCBjdXJyZW50IHdpbmRvdyBpbmZvcm1hdGlvblxuICAgICAgdmFyIHdpbmRvd19oZWlnaHQgPSB3ZWJfd2luZG93LmhlaWdodCgpO1xuICAgICAgdmFyIHdpbmRvd190b3BfcG9zaXRpb24gPSB3ZWJfd2luZG93LnNjcm9sbFRvcCgpO1xuICAgICAgdmFyIHdpbmRvd19ib3R0b21fcG9zaXRpb24gPSAod2luZG93X3RvcF9wb3NpdGlvbiArIHdpbmRvd19oZWlnaHQpO1xuXG4gICAgICAvL2l0ZXJhdGUgdGhyb3VnaCBlbGVtZW50cyB0byBzZWUgaWYgaXRzIGluIHZpZXdcbiAgICAgICQuZWFjaChhbmltYXRpb25fZWxlbWVudHMsIGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAvL2dldCB0aGUgZWxlbWVudCBzaW5mb3JtYXRpb25zXG4gICAgICAgIHZhciBlbGVtZW50ID0gJCh0aGlzKTtcbiAgICAgICAgdmFyIGVsZW1lbnRfaGVpZ2h0ID0gJChlbGVtZW50KS5vdXRlckhlaWdodCgpO1xuICAgICAgICB2YXIgZWxlbWVudF90b3BfcG9zaXRpb24gPSAkKGVsZW1lbnQpLm9mZnNldCgpLnRvcDtcbiAgICAgICAgdmFyIGVsZW1lbnRfYm90dG9tX3Bvc2l0aW9uID0gKGVsZW1lbnRfdG9wX3Bvc2l0aW9uICsgZWxlbWVudF9oZWlnaHQpO1xuXG4gICAgICAgIC8vY2hlY2sgdG8gc2VlIGlmIHRoaXMgY3VycmVudCBjb250YWluZXIgaXMgdmlzaWJsZSAoaXRzIHZpZXdhYmxlIGlmIGl0IGV4aXN0cyBiZXR3ZWVuIHRoZSB2aWV3YWJsZSBzcGFjZSBvZiB0aGUgdmlld3BvcnQpXG4gICAgICAgIGlmICgoZWxlbWVudF9ib3R0b21fcG9zaXRpb24gPj0gd2luZG93X3RvcF9wb3NpdGlvbikgJiYgKGVsZW1lbnRfdG9wX3Bvc2l0aW9uIDw9IHdpbmRvd19ib3R0b21fcG9zaXRpb24pKSB7XG4gICAgICAgICAgJGhlYWRuYXYucmVtb3ZlQ2xhc3MoJ2lzLWFjdGl2ZScpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICRoZWFkbmF2LmFkZENsYXNzKCdpcy1hY3RpdmUnKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICB9XG5cbiAgICAvLyBDaGVjayBNb2Rlcm5penJcbiAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPiAxMTQwKSAge1xuICAgICAgLy9vbiBvciBzY3JvbGwsIGRldGVjdCBlbGVtZW50cyBpbiB2aWV3XG4gICAgICAkKHdpbmRvdykub24oJ3Njcm9sbCByZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNoZWNrX2lmX2luX3ZpZXcoKTtcbiAgICAgIH0pO1xuXG4gICAgICAvL3RyaWdnZXIgb3VyIHNjcm9sbCBldmVudCBvbiBpbml0aWFsIGxvYWRcbiAgICAgICQod2luZG93KS50cmlnZ2VyKCdzY3JvbGwnKTtcbiAgICB9XG5cbiAgfTtcblxuICB2YXIgZmFkZVNjcm9sbCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2Nyb2xsRGlzdGFuY2U7XG4gICAgJCh3aW5kb3cpLnNjcm9sbChvblNjcm9sbEhhbmRsZXIpO1xuXG4gICAgZnVuY3Rpb24gb25TY3JvbGxIYW5kbGVyKCkge1xuICAgICAgdmFyICRmYWRlSXRlbSA9ICQoJy5mYWRlLWl0ZW0nKTtcbiAgICAgIGNvbnNvbGUubG9nKCdzY3JvbGwnKTtcbiAgICAgIHNjcm9sbERpc3RhbmNlID0gJChkb2N1bWVudCkuc2Nyb2xsVG9wKCk7XG4gICAgICAkZmFkZUl0ZW0uZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgIGlmIChpc1Njcm9sbGVkSW50b1ZpZXcodGhpcykgPT09IHRydWUpIHtcbiAgICAgICAgICAkKHRoaXMpLmFkZENsYXNzKCdlbnRlci12aWV3cG9ydCcpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBpc1Njcm9sbGVkSW50b1ZpZXcoZWxlbSkge1xuICAgICAgLy8gZGlzdGFuY2Ugb2YgdG9wIG9mIHBhZ2UsIHRvIGJvdHRvbSBvZiBzY3JlZW4uXG4gICAgICB2YXIgZG9jVmlld0JvdHRvbSA9IHNjcm9sbERpc3RhbmNlICsgJCh3aW5kb3cpLmhlaWdodCgpO1xuXG4gICAgICAvLyBwb3NpdGlvbiBvZiB0aGUgZWxlbWVudFxuICAgICAgdmFyIGVsZW1Ub3AgPSAkKGVsZW0pLm9mZnNldCgpLnRvcDtcblxuICAgICAgLy8gZWxlbWVudHMgYXJlIG9mZnNldCBieSA5MHB4LCBidXQgd2Ugd2FudCB0byBzY3JvbGwgdGhlbSBpbnRvIHZpZXdcbiAgICAgIC8vIG9uY2UgdGhleSBhcmUgMjAwcHggaW50byB2aWV3XG4gICAgICByZXR1cm4gZG9jVmlld0JvdHRvbSA+PSAoZWxlbVRvcCAtIDkwICsgMjAwKTtcbiAgICB9XG5cbiAgICAvLyBsaW1pdCBob3cgb2Z0ZW4gYSBmdW5jdGlvbiBnZXRzIHRyaWdnZXJlZFxuXG4gICAgZnVuY3Rpb24gZGVib3VuY2UoZnVuYywgd2FpdCwgaW1tZWRpYXRlKSB7XG4gICAgICB2YXIgdGltZW91dDtcbiAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBjb250ZXh0ID0gdGhpcyxcbiAgICAgICAgICAgIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICAgIHZhciBsYXRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICB0aW1lb3V0ID0gbnVsbDtcbiAgICAgICAgICBpZiAoIWltbWVkaWF0ZSkge1xuICAgICAgICAgICAgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgdmFyIGNhbGxOb3cgPSBpbW1lZGlhdGUgJiYgIXRpbWVvdXQ7XG4gICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KTtcbiAgICAgICAgdGltZW91dCA9IHNldFRpbWVvdXQobGF0ZXIsIHdhaXQpO1xuICAgICAgICBpZiAoY2FsbE5vdykge1xuICAgICAgICAgIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7XG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfVxuICB9O1xuXG4gIHZhciBiaW5kVUlBY3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBjYW52YXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc25vdycpLFxuICAgICAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKSxcbiAgICAgICAgd2lkdGggPSBjdHguY2FudmFzLndpZHRoID0gZG9jdW1lbnQuYm9keS5vZmZzZXRXaWR0aCxcbiAgICAgICAgaGVpZ2h0ID0gY3R4LmNhbnZhcy5oZWlnaHQgPSBkb2N1bWVudC5ib2R5Lm9mZnNldEhlaWdodCxcbiAgICAgICAgYW5pbUZyYW1lID0gd2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZSB8fFxuICAgICAgICAgICAgICAgICAgICB3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lIHx8XG4gICAgICAgICAgICAgICAgICAgIHdpbmRvdy53ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWUgfHxcbiAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1zUmVxdWVzdEFuaW1hdGlvbkZyYW1lLFxuICAgICAgICBzbm93Zmxha2VzID0gW107XG5cbiAgICB3aW5kb3cub25yZXNpemUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB3aWR0aCA9IGN0eC5jYW52YXMud2lkdGggPSBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoLFxuICAgICAgICBoZWlnaHQgPSBjdHguY2FudmFzLmhlaWdodCA9IGRvY3VtZW50LmJvZHkub2Zmc2V0SGVpZ2h0O1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiB1cGRhdGUoKSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNub3dmbGFrZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc25vd2ZsYWtlc1tpXS51cGRhdGUoKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBTbm93KCkge1xuICAgICAgdGhpcy54ID0gcmFuZG9tKDAsIHdpZHRoKTtcbiAgICAgIHRoaXMueSA9IHJhbmRvbSgtaGVpZ2h0LCAwKTtcbiAgICAgIHRoaXMucmFkaXVzID0gcmFuZG9tKDAuNSwgMy4wKTtcbiAgICAgIHRoaXMuc3BlZWQgPSByYW5kb20oMSwgMyk7XG4gICAgICB0aGlzLndpbmQgPSByYW5kb20oLTAuNSwgMy4wKTtcbiAgICB9XG5cbiAgICBTbm93LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKCkge1xuICAgICAgY3R4LmJlZ2luUGF0aCgpO1xuICAgICAgY3R4LmFyYyh0aGlzLngsIHRoaXMueSwgdGhpcy5yYWRpdXMsIDAsIDIgKiBNYXRoLlBJKTtcbiAgICAgIGN0eC5maWxsU3R5bGUgPSAnI2ZmZic7XG4gICAgICBjdHguZmlsbCgpO1xuICAgICAgY3R4LmNsb3NlUGF0aCgpO1xuICAgIH07XG5cbiAgICBTbm93LnByb3RvdHlwZS51cGRhdGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgICB0aGlzLnkgKz0gdGhpcy5zcGVlZDtcbiAgICAgIHRoaXMueCArPSB0aGlzLndpbmQ7XG5cbiAgICAgIGlmICh0aGlzLnkgPiBjdHguY2FudmFzLmhlaWdodCkge1xuICAgICAgICB0aGlzLnkgPSAwO1xuICAgICAgICB0aGlzLnggPSByYW5kb20oMCwgd2lkdGgpO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBjcmVhdGVTbm93KGNvdW50KSB7XG4gICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGNvdW50OyBpKyspIHtcbiAgICAgICAgc25vd2ZsYWtlc1tpXSA9IG5ldyBTbm93KCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gZHJhdygpIHtcbiAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgY3R4LmNhbnZhcy53aWR0aCwgY3R4LmNhbnZhcy5oZWlnaHQpO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzbm93Zmxha2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHNub3dmbGFrZXNbaV0uZHJhdygpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIGxvb3AoKSB7XG4gICAgICBkcmF3KCk7XG4gICAgICB1cGRhdGUoKTtcbiAgICAgIGFuaW1GcmFtZShsb29wKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiByYW5kb20obWluLCBtYXgpIHtcbiAgICAgIHZhciByYW5kID0gKG1pbiArIE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkudG9GaXhlZCgxKTtcbiAgICAgIHJhbmQgPSBNYXRoLnJvdW5kKHJhbmQpO1xuICAgICAgcmV0dXJuIHJhbmQ7XG4gICAgfVxuXG4gICAgY3JlYXRlU25vdygxNTApO1xuICAgIGxvb3AoKTtcbiAgfTtcblxuICBIb2xpZGF5LmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaGVhZGVyU2Nyb2xsKCk7XG4gICAgYmluZFVJQWN0aW9ucygpO1xuICB9O1xuXG59KHdpbmRvdy5Ib2xpZGF5ID0gd2luZG93LkhvbGlkYXkgfHwge30sIGpRdWVyeSkpO1xuIiwiKGZ1bmN0aW9uIChOZXdzbGV0dGVyTW9kYWwsICQsIHVuZGVmaW5lZCkge1xuXG4gIHZhciAkbmV3c2xldHRlck1vZGFsV3JhcCA9ICQoJy5uZXdzbGV0dGVyLW1vZGFsJyk7XG4gIHZhciAkbmV3c2xldHRlck1vZGFsID0gJCgnLm5ld3NsZXR0ZXItbW9kYWwgLm1vZGFsLWNvbnRlbnRzJyk7XG4gIHZhciAkbmV3c2xldHRlck1vZGFsQ2xvc2UgPSAkKCcuY2xvc2UtbW9kYWwnKTtcbiAgdmFyICRmb3JtID0gJCgnI21jLWVtYmVkZGVkLXN1YnNjcmliZS1mb3JtJyk7XG4gIHZhciAkZm9ybTIgPSAkKCcjbWMtZW1iZWRkZWQtc3Vic2NyaWJlLWZvcm0tMicpO1xuICB2YXIgJGljb25DbG9zZSA9ICQoJy5pY29uLWNsb3NlJyk7XG4gIHZhciBlbWFpbFBvcCA9IHdpbmRvdy5zaG9wLmVtYWlsUG9wO1xuXG4gIC8vIGNvbnNvbGUubG9nKCdlbWFpbCcgKyBlbWFpbFBvcCk7XG5cbiAgdmFyIHNldENvb2tpZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmlzaXRzID0gJC5jb29raWUoJ3Zpc2l0cycpIHx8IDA7XG4gICAgdmlzaXRzKys7XG4gICAgJC5jb29raWUoJ3Zpc2l0cycsIHZpc2l0cywgeyBleHBpcmVzOiAzLCBwYXRoOiAnLycgfSk7XG4gIH07XG5cbiAgdmFyIGluaXRpYWxpemVOZXdzbGV0dGVyTW9kYWwgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCgkLmNvb2tpZSgndmlzaXRzJykgPCAyKSAmJiAhKCQuY29va2llKCdreWxpZUJpcnRoZGF5JykpKSB7XG4gICAgICAvLyAkKHdpbmRvdykubG9hZChmdW5jdGlvbiAoKSB7XG4gICAgICAvLyAgIHZhciBvcHRpb25zID0ge307XG4gICAgICAvLyAgICQoJ1tkYXRhLXJlbW9kYWwtaWQ9bW9kYWxdJykucmVtb2RhbChvcHRpb25zKS5vcGVuKCk7XG4gICAgICAvLyB9KTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygnZW1haWwtYWN0aXZlJyk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGRlbGV0ZUNvb2tpZXMgPSBmdW5jdGlvbiAoKSB7XG4gICAgJC5yZW1vdmVDb29raWUoJ3Zpc2l0cycsIHsgcGF0aDogJy8nIH0pO1xuICAgICQucmVtb3ZlQ29va2llKCdreWxpZUJpcnRoZGF5JywgeyBwYXRoOiAnLycgfSk7XG4gIH07XG5cbiAgZnVuY3Rpb24gcmVnaXN0ZXIoJGZvcm0pIHtcbiAgICAkLmFqYXgoe1xuICAgICAgdHlwZTogJGZvcm0uYXR0cignbWV0aG9kJyksXG4gICAgICB1cmw6ICRmb3JtLmF0dHIoJ2FjdGlvbicpLFxuICAgICAgZGF0YTogJGZvcm0uc2VyaWFsaXplKCksXG4gICAgICBjYWNoZTogZmFsc2UsXG4gICAgICBkYXRhVHlwZTogJ2pzb24nLFxuICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04JyxcbiAgICAgIGVycm9yOiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICQoJy5tb2RhbC1mb3JtJykuaGlkZSgpO1xuICAgICAgICAkKCcubW9kYWwtdGV4dCcpLmhpZGUoKTtcbiAgICAgICAgJCgnI25vdGlmaWNhdGlvbl9jb250YWluZXIsICNub3RpZmljYXRpb25fY29udGFpbmVyLXR3bycpLmh0bWwoJzxzcGFuIGNsYXNzPVxcXCJhbGVydFxcXCI+Q291bGQgbm90IGNvbm5lY3QgdG8gc2VydmVyLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLjwvc3Bhbj4nKTtcbiAgICAgICAgJCgnI25vdGlmaWNhdGlvbl9jb250YWluZXIsICNub3RpZmljYXRpb25fY29udGFpbmVyLXR3bycpLmZhZGVJbigpO1xuICAgICAgICAkbmV3c2xldHRlck1vZGFsV3JhcC5hZGRDbGFzcygnZm9yY2UtcmVsb2FkJyk7XG4gICAgICAgICRuZXdzbGV0dGVyTW9kYWxDbG9zZS5hZGRDbGFzcygnZm9yY2UtcmVsb2FkJyk7XG4gICAgICB9LFxuXG4gICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkge1xuICAgICAgICBpZiAoZGF0YS5yZXN1bHQgIT0gJ3N1Y2Nlc3MnKSB7XG4gICAgICAgICAgdmFyIG1lc3NhZ2UgPSBkYXRhLm1zZy5zdWJzdHJpbmcoMCk7XG4gICAgICAgICAgdmFyIG5vdGlmaWNhdGlvbl9odG1sID0gJzxzcGFuIGNsYXNzPVxcXCJhbGVydFxcXCI+Q291bGQgbm90IGNvbm5lY3QgdG8gc2VydmVyLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLjwvc3Bhbj4nO1xuXG4gICAgICAgICAgaWYgKG1lc3NhZ2UuaW5kZXhPZignaXMgYWxyZWFkeSBzdWJzY3JpYmVkIHRvIGxpc3QnKSA+IC0xKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25faHRtbCA9ICc8c3BhbiBjbGFzcz1cXFwiYWxlcnRcXFwiPlRIQU5LUyEgWU9VXFwnUkUgQUxSRUFEWSBPTiBUSEUgTElTVDwvc3Bhbj4nO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWVzc2FnZS5pbmRleE9mKCdUb28gbWFueSBzdWJzY3JpYmUgYXR0ZW1wdHMgZm9yIHRoaXMgZW1haWwnKSA+IC0xKSB7XG4gICAgICAgICAgICBub3RpZmljYXRpb25faHRtbCA9ICc8c3BhbiBjbGFzcz1cXFwiYWxlcnRcXFwiPlRvbyBtYW55IHN1YnNjcmliZSBhdHRlbXB0cyBmb3IgdGhpcyBlbWFpbCBhZGRyZXNzLjxiciAvPlBsZWFzZSB0cnkgYWdhaW4gaW4gYWJvdXQgNSBtaW51dGVzITwvc3Bhbj4nO1xuICAgICAgICAgIH1cblxuICAgICAgICAgICQoJyNub3RpZmljYXRpb25fY29udGFpbmVyLCAjbm90aWZpY2F0aW9uX2NvbnRhaW5lci10d28nKS5odG1sKG5vdGlmaWNhdGlvbl9odG1sKTtcbiAgICAgICAgICAkKCcjbm90aWZpY2F0aW9uX2NvbnRhaW5lciwgI25vdGlmaWNhdGlvbl9jb250YWluZXItdHdvJykuZmFkZUluKCk7XG4gICAgICAgICAgJG5ld3NsZXR0ZXJNb2RhbFdyYXAuYWRkQ2xhc3MoJ2ZvcmNlLXJlbG9hZCcpO1xuICAgICAgICAgICRuZXdzbGV0dGVyTW9kYWxDbG9zZS5hZGRDbGFzcygnZm9yY2UtcmVsb2FkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdmFyIG1lc3NhZ2UgPSBkYXRhLm1zZztcbiAgICAgICAgICAkZm9ybS5oaWRlKCk7XG4gICAgICAgICAgJCgnI25vdGlmaWNhdGlvbl9jb250YWluZXIsICNub3RpZmljYXRpb25fY29udGFpbmVyLXR3bycpLmh0bWwoJzxzcGFuIGNsYXNzPVxcXCJhbGVydC1zdWNlc3NcXFwiPlRoYW5rIHlvdSBmb3Igc2lnbmluZyB1cDwvc3Bhbj4nKTtcbiAgICAgICAgICAkKCdhLnNob3ctbGlwLWtpdHMnKS50ZXh0KCdDbG9zZSB3aW5kb3cnKTtcbiAgICAgICAgICAkKCcjbm90aWZpY2F0aW9uX2NvbnRhaW5lciwgI25vdGlmaWNhdGlvbl9jb250YWluZXItdHdvJykuZmFkZUluKCk7XG4gICAgICAgICAgJC5jb29raWUoJ2t5bGllQmlydGhkYXknLCAnc3Vic2NyaWJlcicsIHsgZXhwaXJlczogMzY1LCBwYXRoOiAnLycgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICB2YXIgYmluZFVJQWN0aW9ucyA9IGZ1bmN0aW9uICgpIHtcblxuICAgIC8vICQod2luZG93KS5sb2FkKGZ1bmN0aW9uICgpIHtcbiAgICAvLyAgIHZhciBvcHRpb25zID0ge307XG4gICAgLy8gICAkKCdbZGF0YS1yZW1vZGFsLWlkPW1vZGFsXScpLnJlbW9kYWwob3B0aW9ucykub3BlbigpO1xuICAgIC8vIH0pO1xuXG4gICAgJCgnLmt5bGllLWVtYWlsLWhvbGRlcicpLmZvY3VzKGZ1bmN0aW9uICgpIHtcbiAgICAgICQodGhpcykuZGF0YSgncGxhY2Vob2xkZXInLCAkKHRoaXMpLmF0dHIoJ3BsYWNlaG9sZGVyJykpLmF0dHIoJ3BsYWNlaG9sZGVyJywgJycpO1xuICAgIH0pLmJsdXIoZnVuY3Rpb24gKCkge1xuICAgICAgJCh0aGlzKS5hdHRyKCdwbGFjZWhvbGRlcicsICQodGhpcykuZGF0YSgncGxhY2Vob2xkZXInKSk7XG4gICAgfSk7XG5cbiAgICAkbmV3c2xldHRlck1vZGFsQ2xvc2UsICRuZXdzbGV0dGVyTW9kYWxXcmFwLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdmb3JjZS1yZWxvYWQnKSkge1xuICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAkbmV3c2xldHRlck1vZGFsV3JhcC5mYWRlT3V0KCk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICAkKCdhLnNob3ctbGlwLWtpdHMnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAkKCdbZGF0YS1yZW1vZGFsLWlkPW1vZGFsXScpLnJlbW9kYWwoKS5jbG9zZSgpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgJGljb25DbG9zZS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgICAkKCdib2R5JykucmVtb3ZlQ2xhc3MoJ2VtYWlsLWFjdGl2ZScpO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH0pO1xuXG4gICAgJG5ld3NsZXR0ZXJNb2RhbC5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH0pO1xuXG4gICAgJGZvcm0uc3VibWl0KGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJlZ2lzdGVyKCRmb3JtKTtcbiAgICAgICRuZXdzbGV0dGVyTW9kYWxXcmFwLmZhZGVJbigpO1xuICAgIH0pO1xuXG4gICAgJGZvcm0yLnN1Ym1pdChmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZWdpc3RlcigkZm9ybTIpO1xuICAgIH0pO1xuXG4gIH07XG5cbiAgTmV3c2xldHRlck1vZGFsLmluaXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKGVtYWlsUG9wID09IHRydWUpIHtcbiAgICAgIHNldENvb2tpZSgpO1xuICAgICAgaW5pdGlhbGl6ZU5ld3NsZXR0ZXJNb2RhbCgpO1xuICAgIH1cblxuICAgIGJpbmRVSUFjdGlvbnMoKTtcbiAgfTtcblxufSh3aW5kb3cuTmV3c2xldHRlck1vZGFsID0gd2luZG93Lk5ld3NsZXR0ZXJNb2RhbCB8fCB7fSwgalF1ZXJ5KSk7XG4iLCIoZnVuY3Rpb24gKFNsaWRlcnMsICQpIHtcbiAgdmFyIGJpbmRVSUFjdGlvbnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgJCgnLmhwLXNsaWRlcicpLnNsaWNrKHtcbiAgICAgIHNsaWRlc1RvU2hvdzogMSxcbiAgICAgIHNsaWRlc1RvU2Nyb2xsOiAxLFxuICAgICAgYXJyb3dzOiB0cnVlLFxuICAgICAgbGF6eUxvYWQ6ICdwcm9ncmVzc2l2ZScsXG4gICAgICBhdXRvcGxheTogdHJ1ZSxcbiAgICAgIGF1dG9wbGF5U3BlZWQ6IDUwMDBcbiAgICB9KTtcblxuICB9O1xuXG4gIFNsaWRlcnMuaW5pdCA9IGZ1bmN0aW9uICgpIHtcbiAgICBiaW5kVUlBY3Rpb25zKCk7XG4gIH07XG5cbn0od2luZG93LlNsaWRlcnMgPSB3aW5kb3cuU2xpZGVycyB8fCB7fSwgalF1ZXJ5LCB1bmRlZmluZWQpKTtcbiIsIihmdW5jdGlvbiAoVmFsZW50aW5lLCAkKSB7XG4gIHZhciBiaW5kVUlBY3Rpb25zID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciAkY29udGFpbmVyID0gJCgnI3BhY2stY29udGFpbmVyJyk7XG4gICAgdmFyICRNID0gNzY3O1xuICAgICQoZnVuY3Rpb24gKCkge1xuXG4gICAgICAvLyBJc290b3BlXG4gICAgICB2YXIgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI3BhY2stY29udGFpbmVyJyk7XG4gICAgICB2YXIgbXNucnkgPSBuZXcgUGFja2VyeShjb250YWluZXIsIHtcbiAgICAgICAgLy8gb3B0aW9uc1xuICAgICAgICBpdGVtU2VsZWN0b3I6ICcuaXRlbScsXG4gICAgICAgIGd1dHRlcjogMFxuICAgICAgfSk7XG5cbiAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA+PSAkTSkge1xuICAgICAgICAvLyAgaW5pdFBhY2soKTtcbiAgICAgIH07XG5cbiAgICAgICQod2luZG93KS5vbigncmVzaXplJywgZnVuY3Rpb24gKCkge1xuICAgICAgICBpZiAoJCh3aW5kb3cpLndpZHRoKCkgPj0gJE0pIHtcbiAgICAgICAgICAvLyAgaW5pdFBhY2soKTtcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgfSk7XG5cbiAgICAkKCcuaXRlbSBhJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgdmFyIGNvbnRlbnQgPSAkKHRoaXMpLmF0dHIoJ2RhdGEtc3JjLWltZycpO1xuICAgICAgdmFyIGNvbnRlbnRDb250YWluZXIgPSAnPGltZyBzcmM9JyArIGNvbnRlbnQgKyAnIGNsYXNzPVxcJ2l0ZW0gaXRlbS0tY29udGVudFxcJy8+JztcbiAgICAgIHZhciBtb2RhbGZpbGwgPSAkKCcubW9kYWwtZmlsbCcpO1xuICAgICAgJChtb2RhbGZpbGwpLmVtcHR5KCkuYXBwZW5kKGNvbnRlbnRDb250YWluZXIpO1xuICAgICAgdmFyIG9wdGlvbnMgPSB7fTtcbiAgICAgICQoJ1tkYXRhLXJlbW9kYWwtaWQ9bW9kYWwtZ2FsbGVyeV0nKS5yZW1vZGFsKG9wdGlvbnMpLm9wZW4oKTtcbiAgICB9KTtcblxuICB9O1xuXG4gIFZhbGVudGluZS5pbml0ID0gZnVuY3Rpb24gKCkge1xuICAgIGJpbmRVSUFjdGlvbnMoKTtcbiAgfTtcblxufSh3aW5kb3cuVmFsZW50aW5lID0gd2luZG93LlZhbGVudGluZSB8fCB7fSwgalF1ZXJ5LCB1bmRlZmluZWQpKTtcblxuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
